use std::f32::consts::{PI, FRAC_PI_2, TAU};

/// A Taylor series implementation of sin, which assumes 
/// inputs aren't infinite/NaN
pub fn sin_taylor(x: f32) -> f32 {
    let x = x % TAU;
    if x < FRAC_PI_2 {
        sin_taylor_inner(x)
    }
    else if x < PI {
        sin_taylor_inner(PI-x)
    }
    else if x < 3.0*FRAC_PI_2 {
        -sin_taylor_inner(x % PI)
    }
    else {
        -sin_taylor_inner(PI-(x % PI))
    }
    
}

fn sin_taylor_inner(x: f32) -> f32 {
    let mut sum = x;
    let x_squared = x * x;
    let x_cubed = x * x_squared;
    sum -= x_cubed / 6.0;
    let x_to_5 = x_cubed * x_squared;
    sum += x_to_5 / 120.0;
    let x_to_7 = x_to_5 * x_squared;
    sum -= x_to_7 / 5040.0;
    let x_to_9 = x_to_7 * x_squared;
    sum += x_to_9 / 362880.0;
    let x_to_11 = x_to_9 * x_squared;
    sum -= x_to_11 / 39916800.0;
    sum
}

/// A linear interpolation implementation of sin, which assumes 
/// inputs aren't infinite/NaN
pub fn sin_linear(x: f32) -> f32 {
    let x = x % TAU;
    if x < FRAC_PI_2 {
        sin_linear_inner(x)
    }
    else if x < PI {
        sin_linear_inner(PI-x)
    }
    else if x < 3.0*FRAC_PI_2 {
        -sin_linear_inner(x % PI)
    }
    else {
        -sin_linear_inner(PI-(x % PI))
    }
}

fn sin_linear_inner(x: f32) -> f32 {
    let left_index = (1000.0 * x / FRAC_PI_2) as usize;

    let left_sample = SIN_LINEAR_SAMPLES[left_index];
    let right_sample = SIN_LINEAR_SAMPLES[left_index + 1];
    
    let t = x % (FRAC_PI_2 / 1000.0) * (1000.0 / FRAC_PI_2);

    left_sample*t + right_sample*(1.0-t)
}

/// A quadratic interpolation implementation of sin, which assumes 
/// inputs aren't infinite/NaN
pub fn sin_quadratic(x: f32) -> f32 {
    let x = x % TAU;
    if x < FRAC_PI_2 {
        sin_quadratic_inner(x)
    }
    else if x < PI {
        sin_quadratic_inner(PI-x)
    }
    else if x < 3.0*FRAC_PI_2 {
        -sin_quadratic_inner(x % PI)
    }
    else {
        -sin_quadratic_inner(PI-(x % PI))
    }
}

fn sin_quadratic_inner(x: f32) -> f32 {
    let left_index = (100.0 * x / FRAC_PI_2) as usize;

    let left_sample = SIN_QUADRATIC_SAMPLES[left_index];
    let middle_sample = SIN_QUADRATIC_SAMPLES[left_index + 1];
    let right_sample = SIN_QUADRATIC_SAMPLES[left_index + 2];

    let x_0 = left_index as f32 * (FRAC_PI_2 / 100.0);

    let t = x - x_0;

    let t_over_h = t * 100.0;

    let term_1 = 0.5 * t_over_h * t_over_h * (left_sample - 2.0*middle_sample + right_sample);
    let term_2 = 0.5 * t_over_h * (-3.0*left_sample + 4.0*middle_sample - right_sample);
    let term_3 = left_sample;

    term_1 + term_2 + term_3
}

const SIN_QUADRATIC_SAMPLES: [f32; 103] = [
    0.0,
    0.015707318,
    0.03141076,
    0.047106452,
    0.06279052,
    0.0784591,
    0.09410831,
    0.10973431,
    0.12533323,
    0.14090124,
    0.15643448,
    0.1719291,
    0.18738131,
    0.2027873,
    0.21814324,
    0.23344539,
    0.2486899,
    0.26387307,
    0.27899113,
    0.29404032,
    0.309017,
    0.32391742,
    0.33873793,
    0.3534749,
    0.36812454,
    0.38268346,
    0.3971479,
    0.41151437,
    0.42577928,
    0.43993917,
    0.45399055,
    0.46792984,
    0.4817537,
    0.4954587,
    0.5090414,
    0.52249855,
    0.53582686,
    0.5490228,
    0.56208336,
    0.57500523,
    0.58778524,
    0.60042024,
    0.61290705,
    0.6252427,
    0.63742405,
    0.64944804,
    0.6613119,
    0.6730125,
    0.6845471,
    0.6959128,
    0.70710677,
    0.7181263,
    0.7289686,
    0.73963106,
    0.7501111,
    0.760406,
    0.77051324,
    0.78043044,
    0.790155,
    0.79968464,
    0.80901706,
    0.81814975,
    0.8270806,
    0.8358074,
    0.8443279,
    0.85264015,
    0.86074203,
    0.86863154,
    0.8763067,
    0.8837657,
    0.8910065,
    0.89802754,
    0.9048271,
    0.9114033,
    0.91775465,
    0.9238795,
    0.9297765,
    0.93544406,
    0.9408808,
    0.9460854,
    0.95105654,
    0.955793,
    0.9602937,
    0.9645574,
    0.96858317,
    0.9723699,
    0.9759168,
    0.97922283,
    0.9822873,
    0.9851093,
    0.98768836,
    0.9900237,
    0.9921147,
    0.993961,
    0.99556196,
    0.9969173,
    0.9980267,
    0.99888986,
    0.99950653,
    0.9998766,
    1.0,
    0.9998766,
    0.99950653,
];

const SIN_LINEAR_SAMPLES: [f32; 1002] = [
    0.0,
    0.0015707958,
    0.0031415878,
    0.004712372,
    0.0062831445,
    0.007853901,
    0.009424639,
    0.010995354,
    0.012566041,
    0.014136695,
    0.015707318,
    0.0172779,
    0.018848442,
    0.020418935,
    0.021989377,
    0.023559766,
    0.025130099,
    0.026700366,
    0.028270567,
    0.029840698,
    0.03141076,
    0.03298074,
    0.034550644,
    0.036120456,
    0.037690185,
    0.039259817,
    0.040829357,
    0.042398788,
    0.043968122,
    0.045537338,
    0.047106452,
    0.048675444,
    0.050244324,
    0.051813066,
    0.053381696,
    0.05495018,
    0.056518532,
    0.05808675,
    0.05965482,
    0.061222747,
    0.06279052,
    0.064358145,
    0.0659256,
    0.067492895,
    0.06906003,
    0.07062699,
    0.07219377,
    0.07376038,
    0.07532681,
    0.07689305,
    0.0784591,
    0.08002496,
    0.081590615,
    0.08315607,
    0.08472133,
    0.08628637,
    0.087851204,
    0.08941581,
    0.0909802,
    0.09254438,
    0.09410831,
    0.09567203,
    0.09723549,
    0.09879874,
    0.10036173,
    0.10192445,
    0.10348695,
    0.105049185,
    0.10661116,
    0.10817286,
    0.10973431,
    0.11129549,
    0.11285638,
    0.114417,
    0.11597735,
    0.11753741,
    0.11909716,
    0.12065663,
    0.1222158,
    0.123774685,
    0.12533323,
    0.1268915,
    0.12844944,
    0.13000706,
    0.13156436,
    0.13312134,
    0.13467799,
    0.13623431,
    0.13779029,
    0.13934594,
    0.14090124,
    0.14245619,
    0.14401078,
    0.14556503,
    0.14711891,
    0.14867243,
    0.1502256,
    0.15177839,
    0.15333079,
    0.15488282,
    0.15643448,
    0.15798575,
    0.15953662,
    0.16108708,
    0.16263717,
    0.16418684,
    0.16573612,
    0.167285,
    0.16883345,
    0.17038149,
    0.1719291,
    0.1734763,
    0.17502308,
    0.17656939,
    0.1781153,
    0.17966077,
    0.18120576,
    0.18275033,
    0.18429446,
    0.18583812,
    0.18738131,
    0.18892406,
    0.19046634,
    0.19200815,
    0.19354947,
    0.19509032,
    0.19663072,
    0.19817059,
    0.19971,
    0.20124888,
    0.2027873,
    0.20432521,
    0.20586261,
    0.20739952,
    0.2089359,
    0.21047178,
    0.21200714,
    0.21354194,
    0.21507624,
    0.21661001,
    0.21814324,
    0.21967594,
    0.22120811,
    0.22273971,
    0.22427076,
    0.22580127,
    0.22733122,
    0.22886062,
    0.23038943,
    0.2319177,
    0.23344539,
    0.23497248,
    0.236499,
    0.23802495,
    0.23955029,
    0.24107507,
    0.24259923,
    0.24412282,
    0.24564579,
    0.24716814,
    0.2486899,
    0.25021103,
    0.25173154,
    0.25325143,
    0.25477076,
    0.2562894,
    0.2578074,
    0.25932476,
    0.26084152,
    0.2623576,
    0.26387307,
    0.26538786,
    0.266902,
    0.26841548,
    0.2699283,
    0.27144045,
    0.27295196,
    0.27446276,
    0.2759729,
    0.27748233,
    0.27899113,
    0.2804992,
    0.2820066,
    0.28351328,
    0.28501928,
    0.28652456,
    0.28802916,
    0.28953302,
    0.2910362,
    0.2925386,
    0.29404032,
    0.29554132,
    0.2970416,
    0.29854113,
    0.30003992,
    0.30153796,
    0.30303526,
    0.30453184,
    0.30602765,
    0.3075227,
    0.309017,
    0.31051055,
    0.3120033,
    0.31349528,
    0.31498653,
    0.31647697,
    0.31796664,
    0.3194555,
    0.32094362,
    0.32243094,
    0.32391742,
    0.32540312,
    0.32688802,
    0.32837212,
    0.32985544,
    0.3313379,
    0.33281955,
    0.3343004,
    0.33578038,
    0.33725956,
    0.33873793,
    0.34021544,
    0.34169212,
    0.34316793,
    0.34464297,
    0.34611705,
    0.34759033,
    0.34906277,
    0.35053432,
    0.35200503,
    0.3534749,
    0.3549438,
    0.35641187,
    0.3578791,
    0.3593454,
    0.36081082,
    0.3622754,
    0.36373904,
    0.36520177,
    0.3666636,
    0.36812454,
    0.3695846,
    0.3710437,
    0.37250194,
    0.3739592,
    0.3754156,
    0.37687105,
    0.37832552,
    0.3797791,
    0.38123176,
    0.38268346,
    0.3841342,
    0.38558403,
    0.38703284,
    0.38848075,
    0.38992772,
    0.3913737,
    0.3928187,
    0.39426273,
    0.39570582,
    0.3971479,
    0.39858902,
    0.40002915,
    0.4014683,
    0.40290642,
    0.40434358,
    0.40577978,
    0.40721494,
    0.40864912,
    0.41008222,
    0.41151437,
    0.4129455,
    0.41437563,
    0.41580465,
    0.41723272,
    0.41865978,
    0.42008573,
    0.4215107,
    0.4229346,
    0.4243575,
    0.42577928,
    0.42720005,
    0.4286198,
    0.43003845,
    0.4314561,
    0.4328726,
    0.43428808,
    0.43570247,
    0.43711576,
    0.43852803,
    0.43993917,
    0.44134927,
    0.44275823,
    0.44416615,
    0.44557294,
    0.4469786,
    0.4483832,
    0.4497867,
    0.4511891,
    0.45259038,
    0.45399055,
    0.45538953,
    0.45678744,
    0.45818424,
    0.45957986,
    0.4609744,
    0.46236777,
    0.46376002,
    0.46515107,
    0.46654102,
    0.46792984,
    0.46931744,
    0.47070393,
    0.47208926,
    0.47347343,
    0.4748564,
    0.47623825,
    0.47761884,
    0.4789983,
    0.48037657,
    0.4817537,
    0.48312962,
    0.4845043,
    0.48587784,
    0.48725012,
    0.4886212,
    0.48999116,
    0.49135986,
    0.49272737,
    0.49409363,
    0.4954587,
    0.4968225,
    0.49818513,
    0.49954653,
    0.50090665,
    0.5022656,
    0.5036232,
    0.50497967,
    0.5063348,
    0.50768876,
    0.5090414,
    0.51039284,
    0.511743,
    0.51309186,
    0.5144395,
    0.51578593,
    0.517131,
    0.5184748,
    0.51981735,
    0.52115864,
    0.52249855,
    0.52383727,
    0.5251747,
    0.5265107,
    0.5278455,
    0.529179,
    0.5305112,
    0.53184205,
    0.5331716,
    0.5344999,
    0.53582686,
    0.5371524,
    0.53847665,
    0.53979963,
    0.5411213,
    0.5424416,
    0.5437605,
    0.5450781,
    0.54639435,
    0.5477092,
    0.5490228,
    0.55033505,
    0.55164593,
    0.5529554,
    0.55426353,
    0.55557024,
    0.55687565,
    0.5581797,
    0.5594823,
    0.56078357,
    0.56208336,
    0.5633819,
    0.56467897,
    0.56597465,
    0.56726897,
    0.56856185,
    0.56985337,
    0.57114345,
    0.57243216,
    0.5737194,
    0.57500523,
    0.5762897,
    0.5775727,
    0.5788543,
    0.58013445,
    0.5814132,
    0.58269054,
    0.5839664,
    0.5852408,
    0.5865137,
    0.58778524,
    0.5890553,
    0.5903239,
    0.5915911,
    0.5928569,
    0.5941211,
    0.5953838,
    0.5966452,
    0.59790504,
    0.5991634,
    0.60042024,
    0.6016757,
    0.60292953,
    0.60418195,
    0.6054329,
    0.60668236,
    0.60793036,
    0.60917675,
    0.6104217,
    0.6116651,
    0.61290705,
    0.6141475,
    0.61538637,
    0.61662376,
    0.6178596,
    0.61909395,
    0.62032676,
    0.62155807,
    0.62278783,
    0.624016,
    0.6252427,
    0.62646776,
    0.6276914,
    0.6289134,
    0.63013387,
    0.63135284,
    0.63257015,
    0.63378596,
    0.6350002,
    0.6362129,
    0.63742405,
    0.63863355,
    0.6398415,
    0.64104784,
    0.6422527,
    0.64345586,
    0.6446575,
    0.6458576,
    0.647056,
    0.64825284,
    0.64944804,
    0.6506417,
    0.6518337,
    0.6530242,
    0.654213,
    0.6554002,
    0.65658575,
    0.65776974,
    0.65895206,
    0.6601328,
    0.6613119,
    0.66248935,
    0.6636652,
    0.6648393,
    0.66601187,
    0.66718274,
    0.66835207,
    0.66951966,
    0.6706856,
    0.6718499,
    0.6730125,
    0.67417353,
    0.67533284,
    0.6764905,
    0.67764646,
    0.67880076,
    0.6799534,
    0.68110436,
    0.6822536,
    0.6834012,
    0.6845471,
    0.68569136,
    0.68683386,
    0.6879747,
    0.6891138,
    0.6902513,
    0.691387,
    0.692521,
    0.69365335,
    0.6947839,
    0.6959128,
    0.69704,
    0.6981655,
    0.69928914,
    0.70041114,
    0.7015314,
    0.70264995,
    0.70376676,
    0.70488185,
    0.7059952,
    0.70710677,
    0.7082166,
    0.7093247,
    0.7104311,
    0.7115357,
    0.71263856,
    0.7137396,
    0.714839,
    0.7159365,
    0.71703225,
    0.7181263,
    0.71921855,
    0.7203091,
    0.72139776,
    0.72248465,
    0.72356975,
    0.7246531,
    0.7257348,
    0.7268145,
    0.72789246,
    0.7289686,
    0.73004305,
    0.73111564,
    0.7321864,
    0.7332553,
    0.7343225,
    0.7353879,
    0.7364514,
    0.7375131,
    0.738573,
    0.73963106,
    0.7406874,
    0.7417418,
    0.74279433,
    0.74384516,
    0.7448941,
    0.74594116,
    0.7469864,
    0.74802977,
    0.74907136,
    0.7501111,
    0.75114894,
    0.752185,
    0.75321907,
    0.7542514,
    0.75528187,
    0.7563104,
    0.7573371,
    0.75836194,
    0.75938493,
    0.760406,
    0.7614252,
    0.7624425,
    0.76345795,
    0.76447153,
    0.76548326,
    0.766493,
    0.7675009,
    0.76850694,
    0.76951104,
    0.77051324,
    0.7715136,
    0.77251196,
    0.7735085,
    0.7745031,
    0.77549577,
    0.7764865,
    0.77747536,
    0.77846235,
    0.7794473,
    0.78043044,
    0.7814115,
    0.78239083,
    0.7833681,
    0.78434354,
    0.78531694,
    0.78628844,
    0.787258,
    0.78822565,
    0.7891913,
    0.790155,
    0.7911168,
    0.79207665,
    0.7930345,
    0.7939904,
    0.79494435,
    0.79589635,
    0.7968464,
    0.79779446,
    0.7987405,
    0.79968464,
    0.8006268,
    0.801567,
    0.8025052,
    0.8034414,
    0.8043757,
    0.8053079,
    0.8062382,
    0.80716646,
    0.8080927,
    0.80901706,
    0.8099393,
    0.81085956,
    0.8117779,
    0.8126942,
    0.81360847,
    0.8145208,
    0.815431,
    0.81633925,
    0.81724554,
    0.81814975,
    0.819052,
    0.81995213,
    0.82085025,
    0.82174647,
    0.82264054,
    0.8235326,
    0.82442266,
    0.82531065,
    0.8261967,
    0.8270806,
    0.82796246,
    0.8288423,
    0.82972014,
    0.8305959,
    0.83146966,
    0.83234125,
    0.8332109,
    0.8340785,
    0.83494395,
    0.8358074,
    0.8366687,
    0.8375281,
    0.8383853,
    0.8392405,
    0.84009355,
    0.8409446,
    0.8417936,
    0.8426404,
    0.84348524,
    0.8443279,
    0.84516853,
    0.84600717,
    0.84684354,
    0.84767795,
    0.84851027,
    0.84934044,
    0.8501685,
    0.85099447,
    0.8518184,
    0.85264015,
    0.8534599,
    0.85427743,
    0.8550929,
    0.8559063,
    0.85671747,
    0.8575267,
    0.85833365,
    0.8591386,
    0.85994136,
    0.86074203,
    0.8615406,
    0.862337,
    0.8631313,
    0.86392343,
    0.8647135,
    0.8655014,
    0.8662871,
    0.86707073,
    0.8678522,
    0.86863154,
    0.86940867,
    0.87018377,
    0.87095666,
    0.8717274,
    0.87249607,
    0.87326247,
    0.8740268,
    0.8747889,
    0.8755489,
    0.8763067,
    0.8770623,
    0.87781584,
    0.87856716,
    0.87931633,
    0.88006335,
    0.8808081,
    0.8815508,
    0.88229126,
    0.8830295,
    0.8837657,
    0.88449955,
    0.8852313,
    0.8859609,
    0.8866883,
    0.88741344,
    0.88813645,
    0.88885725,
    0.8895759,
    0.89029235,
    0.8910065,
    0.89171857,
    0.8924284,
    0.893136,
    0.89384145,
    0.8945446,
    0.8952457,
    0.8959445,
    0.8966411,
    0.89733547,
    0.89802754,
    0.8987176,
    0.89940524,
    0.90009075,
    0.900774,
    0.9014551,
    0.90213394,
    0.9028106,
    0.903485,
    0.9041571,
    0.9048271,
    0.90549475,
    0.90616024,
    0.90682346,
    0.9074844,
    0.9081432,
    0.9087997,
    0.909454,
    0.910106,
    0.91075575,
    0.9114033,
    0.9120486,
    0.9126916,
    0.91333234,
    0.91397095,
    0.9146072,
    0.9152412,
    0.91587293,
    0.9165024,
    0.9171297,
    0.91775465,
    0.91837734,
    0.91899776,
    0.9196159,
    0.9202319,
    0.9208455,
    0.9214569,
    0.922066,
    0.92267275,
    0.9232773,
    0.9238795,
    0.92447954,
    0.9250772,
    0.92567265,
    0.9262658,
    0.9268566,
    0.9274452,
    0.92803144,
    0.92861545,
    0.9291971,
    0.9297765,
    0.9303536,
    0.9309284,
    0.9315009,
    0.9320711,
    0.932639,
    0.93320465,
    0.933768,
    0.934329,
    0.93488765,
    0.93544406,
    0.93599814,
    0.9365499,
    0.9370994,
    0.9376465,
    0.93819135,
    0.9387339,
    0.9392741,
    0.93981194,
    0.9403475,
    0.9408808,
    0.94141173,
    0.9419403,
    0.94246656,
    0.94299054,
    0.9435122,
    0.9440315,
    0.9445485,
    0.94506305,
    0.94557536,
    0.9460854,
    0.94659305,
    0.9470983,
    0.94760126,
    0.94810194,
    0.94860023,
    0.94909614,
    0.9495897,
    0.950081,
    0.95057,
    0.95105654,
    0.95154077,
    0.9520226,
    0.95250213,
    0.9529793,
    0.9534542,
    0.9539267,
    0.9543968,
    0.95486456,
    0.95532995,
    0.955793,
    0.9562537,
    0.95671207,
    0.95716804,
    0.95762163,
    0.9580729,
    0.9585218,
    0.9589683,
    0.9594125,
    0.95985425,
    0.9602937,
    0.96073073,
    0.9611654,
    0.96159774,
    0.96202767,
    0.9624553,
    0.96288043,
    0.96330327,
    0.96372366,
    0.9641417,
    0.9645574,
    0.9649707,
    0.9653817,
    0.96579015,
    0.96619636,
    0.9666001,
    0.9670015,
    0.9674005,
    0.9677971,
    0.9681913,
    0.96858317,
    0.9689726,
    0.96935964,
    0.9697443,
    0.9701266,
    0.9705065,
    0.97088397,
    0.97125906,
    0.97163177,
    0.972002,
    0.9723699,
    0.97273546,
    0.9730985,
    0.9734592,
    0.9738175,
    0.9741734,
    0.9745269,
    0.97487795,
    0.97522664,
    0.9755729,
    0.9759168,
    0.9762582,
    0.97659725,
    0.9769339,
    0.97726816,
    0.9776,
    0.97792935,
    0.97825634,
    0.9785809,
    0.97890306,
    0.97922283,
    0.9795401,
    0.97985506,
    0.98016757,
    0.98047763,
    0.9807853,
    0.9810905,
    0.98139334,
    0.98169374,
    0.9819917,
    0.9822873,
    0.98258036,
    0.9828711,
    0.98315936,
    0.9834452,
    0.98372865,
    0.9840096,
    0.9842882,
    0.98456436,
    0.98483807,
    0.9851093,
    0.9853782,
    0.9856446,
    0.98590857,
    0.9861702,
    0.9864293,
    0.986686,
    0.9869402,
    0.98719203,
    0.9874414,
    0.98768836,
    0.98793286,
    0.9881749,
    0.9884146,
    0.98865175,
    0.9888865,
    0.9891188,
    0.9893487,
    0.9895761,
    0.9898011,
    0.9900237,
    0.9902438,
    0.9904614,
    0.99067664,
    0.99088943,
    0.9910998,
    0.9913076,
    0.9915131,
    0.9917161,
    0.9919166,
    0.9921147,
    0.99231035,
    0.9925036,
    0.9926943,
    0.9928826,
    0.99306846,
    0.99325186,
    0.9934328,
    0.9936113,
    0.99378735,
    0.993961,
    0.9941321,
    0.9943008,
    0.994467,
    0.9946308,
    0.99479216,
    0.994951,
    0.9951075,
    0.99526143,
    0.99541295,
    0.99556196,
    0.9957086,
    0.9958527,
    0.9959944,
    0.9961336,
    0.99627036,
    0.9964047,
    0.99653655,
    0.99666595,
    0.99679285,
    0.9969173,
    0.9970394,
    0.9971589,
    0.997276,
    0.9973906,
    0.9975028,
    0.99761254,
    0.99771976,
    0.99782455,
    0.9979269,
    0.9980267,
    0.9981241,
    0.9982191,
    0.9983115,
    0.9984015,
    0.9984891,
    0.9985742,
    0.9986568,
    0.998737,
    0.99881464,
    0.99888986,
    0.99896264,
    0.9990329,
    0.99910074,
    0.99916613,
    0.999229,
    0.99928945,
    0.99934745,
    0.99940294,
    0.999456,
    0.99950653,
    0.9995547,
    0.9996003,
    0.9996435,
    0.9996842,
    0.9997224,
    0.9997582,
    0.9997915,
    0.9998224,
    0.99985075,
    0.9998766,
    0.99990004,
    0.999921,
    0.99993956,
    0.9999556,
    0.9999692,
    0.9999803,
    0.9999889,
    0.99999505,
    0.99999875,
    1.0,
    0.99999875,
];